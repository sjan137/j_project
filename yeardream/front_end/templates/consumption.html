<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../static/css/menu_style.css">
  <script src="https://kit.fontawesome.com/b3e71536be.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
  <script src="../static/js/index.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
  <!-- Plotly.js -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  {% if title %}
    <title>YEARDREAM APP-{{title}}</title>
  {% else %}
    <title>YEARDREAM APP</title>
  {% endif %}
</head>
<body>
  <nav class="navbar">
    <div class="navbar_logo">
      <i class="fas fa-horse"></i>
      <a href={{ url_for('index') }}>Pink Horse</a>

    </div>
    <ul class="navbar_menu">
      <li><a href={{ url_for('consumption') }}>소비</a></li>
      <li><a href={{ url_for('culture') }}>문화</a></li>
      <li><a href={{ url_for('index') }}>Pink Horse</a></li>
      <li><a href={{ url_for('living') }}>생활</a></li>
      <li><a href={{ url_for('metro') }}>교통</a></li>
    </ul>
    <ul class="navbar_icons">
      <li><a href="https://yeardream-gitlab.elice.io/yeardream-project/project-4" class="fab fa-gitlab"></a></li>
      <li><i class="fas fa-bomb"></i></li>
    </ul>

    <a href="#" class="navbar_toggleBtn">
      <i class="fas fa-bars"></i>
    </a>
  </nav>
  <div id="container">
    <div id="myDiv"></div>
    </div>

  <script>
    Plotly.d3.csv("https://raw.githubusercontent.com/plotly/datasets/master/2014_apple_stock.csv", function(err, rows){

      function unpack(rows, key) {
      return rows.map(function(row) { return row[key]; });
    }
      
      var frames = []
      var x = unpack(rows, 'AAPL_x')
      var y = unpack(rows, 'AAPL_y')
    
      var n = 100;
      for (var i = 0; i < n; i++) { 
        frames[i] = {data: [{x: [], y: []}]}
        frames[i].data[0].x = x.slice(0, i+1);
        frames[i].data[0].y = y.slice(0, i+1);
      }
    
      Plotly.newPlot('myDiv', [{
        x: frames[1].data[0].x,
        y: frames[1].data[0].y,
        fill: 'tozeroy',
        type: 'scatter',
        mode: 'lines',
        line: {color: 'green'}
      }], {
        xaxis: {
          type: 'date', 
          range: [
            frames[99].data[0].x[0], 
            frames[99].data[0].x[99]
          ],
          showgrid: false,
          showline: false,
          showticklabels: false,
          zeroline: false
        },
        yaxis: {
          range: [
            0, 
            90
          ],
          showgrid: false,
          showline: false,
          showticklabels: false,
          zeroline: false
        },
        annotations: [{
          showarrow: false,
          text: "<b>TESTING</b>",
          font: {
            family: 'Gravitas One',
            size: 48,
            color: 'white'
          },
          xref: 'paper',
          yref: 'paper',
          x: 0.5,
          y: 0.5
        }, {
          showarrow: false,
          text: "testing | testing | testing",
          font: {
            family: 'Gravitas One',
            size: 16,
            color: 'white'
          },
          xref: 'paper',
          yref: 'paper',
          x: 0.5,
          y: 0.35
        }]
      }).then(function() {
        Plotly.animate('myDiv', frames, {
          transition: {
            duration: 0
          },
          frame: {
            duration: 20,
            redraw: false
          }
      });
      });
      
    }) 
  </script>

  [{% for item in labels %}
  "{{item}}",
  {% endfor %}] 
  [{% for item in values %}
    {{item}},
  {% endfor %}]
  
</body>
</html>